@model LibraryProjectWebSite.Models.LibraryViewModel
@if (ViewBag.Role == "user" || ViewBag.isLoggedIn == false)
{
    Layout = "~/Views/Shared/_LayoutUser.cshtml";
    <div style="background-image: url(../public/images/library.jpg)" class="mb-0">
        <div style="background-image: url(../public/images/library.jpg)" class="justify-content-center">
            <div class="hero container page__container text-center py-112pt">
                <h1 class="text-white text-shadow">Borrow Books</h1>
                <p class="lead measure-hero-lead mx-auto text-white text-shadow mb-48pt">
                    The borrow system is available to our users now.
                    Through this system, you can rent a book from anywhere you want or reserve it for yourself.
                </p>

                <a href="login.html"
                   class="btn btn-lg btn-white btn--raised mb-16pt">Browse Books</a>

                <p class="mb-0">
                    <a href="https://localhost:44361/Home/OfficerLogin"
                       class="text-white text-shadow"><strong>Are you a librarian?</strong></a>
                </p>
            </div>

        </div>
    </div>
    <div class="border-bottom-2 py-16pt navbar-light bg-white border-bottom-2">
        <div>
            <div class="row align-items-center">
                <div style="padding-left: 240px;" class="d-flex col-md align-items-center border-bottom border-md-0 mb-16pt mb-md-0 pb-16pt pb-md-0">
                    <div class="rounded-circle bg-primary w-64 h-64 d-inline-flex align-items-center justify-content-center mr-16pt">
                        <!--                                    <img src="../public/images/paths/"-->
                        <!--                                         width="40"-->
                        <!--                                         height="40"-->
                        <!--                                         alt="Angular"-->
                        <!--                                         class="rounded">-->
                    </div>
                    <div class="flex">
                        <div style="font-weight: 600;" class="card-title mb-4pt">13,000+ Books</div>
                        <p class="card-subtitle text-70">Discover books with an increasing number every day.</p>
                    </div>
                </div>
                <div class="d-flex col-md align-items-center border-bottom border-md-0 mb-16pt mb-md-0 pb-16pt pb-md-0">
                    <div class="rounded-circle bg-primary w-64 h-64 d-inline-flex align-items-center justify-content-center mr-16pt">
                        <i class="material-icons text-white">verified_user</i>
                    </div>
                    <div class="flex">
                        <div style="font-weight: 600;" class="card-title mb-4pt">+250 Registered Library</div>
                        <p class="card-subtitle text-70">For now!   </p>
                    </div>
                </div>
                <div class="d-flex col-md align-items-center">
                    <div class="rounded-circle bg-primary w-64 h-64 d-inline-flex align-items-center justify-content-center mr-16pt">
                        <i class="material-icons text-white">update</i>
                    </div>
                    <div class="flex">
                        <div style="font-weight: 600" class="card-title mb-4pt">Unlimited Time Earned</div>
                        <p class="card-subtitle text-70">Now, your time on the road is yours!</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <div class="page-section border-bottom-2">
        <div class="container page__container">
            <form class="search-form navbar-search d-none d-lg-flex mr-16pt"
                  action="index.html"
                  style="max-width: 230px">
                <button class="btn"
                        type="submit">
                    <i class="material-icons">search</i>
                </button>
                <input type="text"
                       class="form-control"
                       placeholder="Search books ...">
            </form>
            <div class="page-separator">
                <div class="page-separator__text">MOST LIKED THIS WEEK</div>
            </div>

            @foreach (var book in Model.Books)
            {
                <a href="https://localhost:44361/Home/GetById/@book.Id">
                    <div class="row card-group-row">
                        <div class="col-md-6 col-lg-12 card-group-row__col">
                            <div class="card card--elevated posts-card-popular overlay card-group-row__card">
                                <img src=@($"https://covers.openlibrary.org/b/isbn/{book.ISBN10}-M.jpg")
                                     alt=""
                                     style="width:15%;margin-left:295px;"
                                     class="card-img">
                                <div class="fullbleed bg-primary"
                                     style="opacity: .3"></div>
                                <div class="posts-card-popular__content">
                                    <div style="color: white;font-weight: 500;font-size: 17px;float: right;padding-right: 90px;padding-top: 60px">
                                        <p>
                                            @book.Description
                                        </p>

                                        @if (book.Libraries.Count == 0)
                                        {
                                            <p style="padding-top: 60px; color: black;">
                                                This book is not available
                                            </p>
                                        }
                                        else if (!@book.Libraries.Where(x => x.Quantity > 0).Any())
                                        {
                                            <p style="padding-top: 85px; color: black;">
                                                Book is out of stock
                                            </p>
                                        }



                                    </div>
                                    <div class="posts-card-popular__title card-body">
                                        @foreach (var category in book.Categories)
                                        {
                                            <small style="font-weight:500;" class=" text-uppercase">@category.Name</small><br />
                                        }
                                        <br />
                                        <p style="font-weight:800;margin-bottom:7px;margin-top:-8px;font-size:15px;">@book.Name</p>
                                        @foreach (var author in book.Authors)
                                        {
                                            <p style="margin-bottom:0px;font-weight:500;">@author.Name</p>
                                        }
                                    </div>
                                </div>
                            </div>

                        </div>


                    </div>
                </a>
            }

            <button style="border-radius: 10px;width: 200px;margin-left: 350px">More</button>
            <div class="posts-cards">
            </div>
        </div>
    </div>

}
else if (ViewBag.Role == "officer")
{
    Layout = "~/Views/Shared/_LayoutOfficer.cshtml";


    <div class="pt-32pt">
        <div class="container page__container d-flex flex-column flex-md-row align-items-center text-center text-sm-left">
            <div class="flex d-flex flex-column flex-sm-row align-items-center mb-24pt mb-md-0">

                <div class="mb-24pt mb-sm-0 mr-sm-24pt">
                    <h2 class="mb-0">Welcome Mert Demirsoy</h2>
                </div>
            </div>
        </div>
    </div>
    <div class="page-section border-bottom-2">
        <div class="container page__container">

            <div style="margin-top: -90px;" class="row">
                <div class="col-lg-4">
                    <div class="card border-1 border-left-3 border-left-accent text-center mb-lg-0">
                        <div class="card-body">
                            <h4 class="h2 mb-0">92 Books</h4>
                            <div>Barrowed this month</div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card text-center mb-lg-0">
                        <div class="card-body">
                            <h4 class="h2 mb-0">826 Click</h4>
                            <div>Total Clicks on Your Books</div>
                        </div>
                    </div>
                </div>
                <div class="col-lg-4">
                    <div class="card text-center mb-lg-0">
                        <div class="card-body">
                            <h4 class="h2 mb-0">102 Favourites</h4>
                            <div>Total Favourites</div>
                        </div>
                    </div>
                </div>
            </div>

        </div>
    </div>
    <div style="padding-top: 3rem!important;" class="container page__container page-section">
        <div class="row mb-8pt">
            <div class="col-lg-6">

                <div class="page-separator">
                    <div class="page-separator__text">Pending Borrow transactions</div>
                </div>
                <div class="card">
                    <div data-toggle="lists"
                         data-lists-values='[
      "js-lists-values-course",
      "js-lists-values-document",
      "js-lists-values-amount",
      "js-lists-values-date"
    ]'
                         data-lists-sort-by="js-lists-values-date"
                         data-lists-sort-desc="true"
                         class="table-responsive">
                        <table class="table table-flush table-nowrap">
                            <thead>
                                <tr>
                                    <th colspan="2">
                                        <a href="javascript:void(0)"
                                           class="sort"
                                           data-sort="js-lists-values-course">Image</a>
                                        <a href="javascript:void(0)"
                                           class="sort"
                                           data-sort="js-lists-values-document">Name</a>
                                        <a href="javascript:void(0)"
                                           class="sort"
                                           data-sort="js-lists-values-date">Date</a>
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="list">
                                @foreach (var borrow in Model.Borrows)
                                {
                                    <tr>
                                        <td>
                                            <div class="d-flex flex-nowrap align-items-center">
                                                <a href="edit-books.html"
                                                   class="avatar avatar-4by3 overlay overlay--primary mr-12pt">
                                                    <img src="../public/images/harry.jpg"
                                                         alt="course"
                                                         class="avatar-img rounded">
                                                    <span class="overlay__content"></span>
                                                </a>
                                                <div class="flex">
                                                    <a class="card-title js-lists-values-course"
                                                       href="edit-books.html">@borrow.Book.Name</a>
                                                </div>
                                            </div>
                                        </td>
                                        <td class="text-right">
                                            <small class="text-muted text-uppercase js-lists-values-date">@borrow.User.Name</small>
                                        </td>
                                        <td class="text-right">
                                            <small class="text-muted text-uppercase js-lists-values-date">@borrow.BorrowDate.ToString("dd/MM/yyyy")</small>
                                        </td>
                                    </tr>
                                }



                            </tbody>
                        </table>
                    </div>
                </div>

            </div>
            <div class="col-lg-6">

                <div class="page-separator">
                    <div class="page-separator__text">Waiting Comments</div>
                </div>
                <div class="card">
                    <div class="card-body unapprovedCommentWrapper">



                    </div>

                </div>
            </div>

        </div>

    </div>

}

@section scripts{
    <script type="text/javascript">

        var index = {
            init: function () {
                if ($('.unapprovedCommentWrapper').length > 0) {
                    index.getUnapprovedComment();
                }
            },
            getUnapprovedComment: function () {
                $.post("/Home/_UnapprovedComment", function (res) {
                    $('.unapprovedCommentWrapper').html(res);
                });
            },
            approveComment: function (row) {
                var item = $(row).data();
                $.post("/Home/CommentConfirmation", { id: item.id, status: true }, function (res) {
                    index.getUnapprovedComment();
                });
            },
            removeComment: function (row) {
                var item = $(row).data();
                $.post("/Home/CommentConfirmation", { id: item.id, status: false }, function (res) {
                    index.getUnapprovedComment();
                });
            }
        }


        $(document).ready(function () {
            index.init();
        });

    </script>
}

